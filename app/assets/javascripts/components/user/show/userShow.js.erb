angular
  .module('eventPlanner')
  .component('userShow', {
    templateUrl: '<%= asset_path("components/user/show/userShow") %>',
    controller: UserShowController
  });

UserShowController.$inject = ['$stateParams', 'UserService', 'CommentService'];

function UserShowController($stateParams, UserService, CommentService) {
  var vm = this;

  vm.user = {};
  vm.comments = [];
  vm.addToCommentsArray = addToCommentsArray;
  vm.deleteComment = deleteComment;

	activate()

	function activate() {
		getUser()
	}

	function getUser() {
		UserService
			.getUser($stateParams.id)
			.then(function assignUser(response) {
				console.log(response.data);
				vm.user = response.data;
			});
	}

    function deleteComment(id) {
		CommentService
			.deleteComment($stateParams.id, id)
			.then(function(response) {
                // vm.comments.splice = []
                vm.comments = [];
				response.data.comments.forEach(addToCommentsArray)
			});
	}

    function addToCommentsArray(comment) {
        vm.comments.push(comment);
    }
}
