angular
  .module('eventPlanner')
  .component('eventShow', {
    templateUrl: '<%= asset_path("components/event/show/eventShow") %>',
    controller: EventShowController
  });

  EventShowController.$inject = ['$state','$stateParams', 'EventService', 'FavoritesService','UserService', 'CommentService'];

function EventShowController($state, $stateParams, EventService, FavoritesService, UserService, CommentService) {
  var vm = this;

    vm.event = {};
    vm.comments = {};
	vm.isFavorite = false;
    vm.newComment = {};
    vm.commentSubmit = commentSubmit;

	vm.getEvent = getEvent;
	vm.favoriteEvent = favoriteEvent;

	activate()

	function activate() {
		getEvent()
	}

    function commentSubmit(){
        console.log("form has been submitted");
        CommentService
        .postComment(vm.newComment, $stateParams.id)
        .then(function(response){
            console.log(response);
        })
    }
	function favoriteEvent() {
		FavoritesService
			.favoriteEvent($stateParams.id)
			.then(function(response) {
				console.log(response);
			})
	}
	function getEvent() {
    EventService
			.getEvent($stateParams.id)
			.then(function assignEvent(response) {
				console.log(response.data);
				vm.event = response.data.eventful;
                vm.comments = response.data.comments;
				// UserService
				// 	.getUser(response.data.user.id)
				// 	.then(function setFavorite(response) {
				// 		console.log(response.data.eventUsers);
				// 		vm.isFavorite = response.data.eventUsers[0].is_favorite;
				// 	})
			})
	}
}
